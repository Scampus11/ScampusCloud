ALTER PROCEDURE [dbo].[SP_StudentAccessGroup_CURD]
@Id int = null,
@StudentId nvarchar(50) = '',
@CompanyId uniqueidentifier = null,
@CanteenType INT = null,
@AccessGroupId nvarchar(100) = null,
@Isactive bit = 0,
@CreatedBy uniqueidentifier=null,
@ModifiedBy uniqueidentifier=null,
@ActionType nvarchar(20) = ''

AS

BEGIN
    IF @ActionType = 'Update'
	BEGIN
	    UPDATE Tbl_Mstr_Student_Access_Group_Control SET CanteenTypeId = @CanteenType,AccessGroupId = @AccessGroupId WHERE StudentId = @StudentId
	END

	IF @ActionType = 'Edit' OR @ActionType='Remote'
	BEGIN  
		select C.Id,C.CompanyId,C.StudentId,C.ImagePath,C.ImageBase64,C.FirstName AS StudentName,C.Code,SAGC.CanteenTypeId AS AccessGroupTypeId,
		C.CreatedBy,C.ModifiedBy,C.Isactive,SAGC.Id as AccessGroupControlId
		from Tbl_Mstr_Student_Master C 
		LEFT JOIN Tbl_Mstr_Student_Access_Group_Control SAGC ON C.StudentId =  SAGC.StudentId
		WHERE (C.Id=@Id) and C.CompanyId=@CompanyId
	END  
	IF @ActionType = 'Delete'  
	BEGIN  
		UPDATE Tbl_Mstr_Student_Access_Group_Control SET CanteenTypeId = @CanteenType,AccessGroupId = @AccessGroupId WHERE StudentId = @StudentId
	END  
END
