CREATE PROCEDURE [dbo].[SP_DownloadVisitorData_Export]
@Search nvarchar(max)='',
@CompanyId nvarchar(100)=''

AS
BEGIN
		SELECT CONCAT(c.FirstName,'',c.LastName) as [Fullname],C.VisitorRegNumber,c.EmailId,c.PhoneNumber,c.VisitorPreRegStatus,
		c.Code,VTM.Name AS VisitorType,VRM.Name as VisitorReason from Tbl_Mstr_Visitor_Master c
		INNER JOIN Tbl_Mstr_VisitorType_Master AS VTM ON C.VisitorTypeIds = VTM.Id
		INNER JOIN Tbl_Mstr_VisitorReason_Master AS VRM ON C.VisitorreasonIds = VRM.Id
		WHERE (C.Id LIKE '%' + @Search + '%' or C.FirstName LIKE '%' + @Search + '%' or c.Code LIKE '%' + @Search + '%')
		and c.CompanyId=@CompanyId
END
